<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Google Summer of Code: week 2" /><meta name="author" content="Gerardo" /><meta property="og:locale" content="en_US" /><meta name="description" content="data, computers, and mathematics" /><meta property="og:description" content="data, computers, and mathematics" /><meta property="og:site_name" content="Gerardo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-20T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Google Summer of Code: week 2" /><meta name="twitter:site" content="@grrddm" /><meta name="twitter:creator" content="@Gerardo" /> <script type="application/ld+json"> {"datePublished":"2021-06-20T00:00:00+01:00","description":"data, computers, and mathematics","mainEntityOfPage":{"@type":"WebPage","@id":"/2021/06/20/gsoc2"},"url":"/2021/06/20/gsoc2","author":{"@type":"Person","name":"Gerardo"},"headline":"Google Summer of Code: week 2","dateModified":"2021-06-20T00:00:00+01:00","@type":"BlogPosting","@context":"https://schema.org"}</script><title> Google Summer of Code: week 2 - Gerardo</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Gerardo" href="/atom.xml"><link rel="alternate" type="application/json" title="Gerardo" href="/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script src="https://kit.fontawesome.com/23a90fcaa1.js" crossorigin="anonymous"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}</style><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-137916168-1', 'auto'); ga('send', 'pageview'); </script></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Gerardo</h1>--><nav role="navigation"><ul><li><a href="/" >Writing</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav></header><section class="post"><h2>Google Summer of Code: week 2</h2><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous" /><h2 id="a-summary-of-this-week">A summary of this week</h2><p>GSoC week 3 was all about Kalman Filtering. This week I got to work with the classical Kalman Filter (KF) equations, the Extended Kalman Filter (EKF), the Unscented Kalman Filter (UKF), and tested their behaviour in both continuous and discrete time.</p><h3 id="kalman-filter-in-systems-with-limit-cycles">Kalman Filter in systems with limit cycles</h3><p>My first task of the week consisted in making a demo of the Kalman Filter equations using a system with a limit cycle. Specifically, we wanted to observe the behaviour of the KF equations when the latent space had the following form</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex"> {\bf A} = \begin{bmatrix} 0 &amp; 1\\ -1 &amp; 0 \end{bmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>The observed space, on the other hand, was driven by and identity matrix with added diagonal noise. The result is the following:</p><p float="left"> <img src="https://imgur.com/owWhRpX.png" width="300" /> <img src="https://imgur.com/ljvocnA.png" width="300" /></p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/kf_circle_demo.py">kf_circle_demo.py</a></li></ul><h3 id="ukf-vs-ekf">UKF v.s. EKF</h3><p>My next task was to create a demo that could compare the use of EKF and UKF using a <em>simple</em> nonlinear system. The main objective was to visualize how sometimes EKF fails when UKF does not. To create this demo, I had to implement a UKF class and come up with an example in which UKF works, but EKF does not. I did not have to look very far. The following graphs show the performance of the EKF and the UKF algorithms under the latent system.</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo>+</mo><mi mathvariant="normal">Δ</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> f_z(x, y) = (x + \Delta \sin(y), y + \Delta \cos(x)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>The observed state was assumed to be governed by an identity function.</p><p float="left"> <img src="https://imgur.com/5XdGxEw.png" width="300" /> <img src="https://imgur.com/fKw2mPC.png" width="300" /> <img src="https://imgur.com/eOQgHif.png" width="300" /></p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/ekf_vs_ukf_demo.py">ekf_vs_ukf_demo.py</a></li><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/dynamical_systems_lib.py">dynamical_systems_lib</a></li></ul><h3 id="more-refactoring">More refactoring</h3><p>My final task this week was to standardise every demo and code that I’ve written for the linear dynamical systems and the dynamical systems’ libraries. What started as a single issue became the work for most of the week. Below is a simple summary of what was done for the KF and EKF classes.</p><table><thead><tr><th> </th><th>KF</th><th>EKF</th></tr></thead><tbody><tr><td>Discrete</td><td><code>KalmanFilter</code></td><td><code>ExtendedKalmanFilter</code></td></tr><tr><td>Continuous</td><td><code>ContinuousKalmanFilter</code></td><td><code>ContinuousExtendedKalmanFilter</code></td></tr><tr><td>filename</td><td><code>linear_dynamical_systems_lib.py</code></td><td><code>dynamical_systems_lib.py</code></td></tr></tbody></table><p>By the end of the week, I am glad to write, we had a concise and standardised library for KF, UKF and EKF. Is important to remark that these libraries are written to be read and not to be used in production. They are designed to make the transition from math to code as smooth as possible, all while using the hottest library in Python ML right now: jax.</p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/pull/521">PR Request #521</a></li></ul><span class="meta"><time datetime="2021-06-20T00:00:00+01:00">June 20, 2021</time> &middot; <a href="/tag/gsoc">gsoc</a>, <a href="/tag/personal">personal</a></span></section></main></body></html>
