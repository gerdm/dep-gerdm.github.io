<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Google Summer of Code: week 0" /><meta name="author" content="Gerardo" /><meta property="og:locale" content="en_US" /><meta name="description" content="This week marked the end of week 0 of the 2021 Google Summer of Code (GSoC). This year, I got accepted to work on the “Converting ML Matlab Examples to Python using JAX” under the Tensorflow organization. The goal of the project is to translate machine learning Matlab code to Python/Jax for Kevin Murphy’s second volume of his upcoming book “Probabilistic Machine Learning: Advanced Topics”." /><meta property="og:description" content="This week marked the end of week 0 of the 2021 Google Summer of Code (GSoC). This year, I got accepted to work on the “Converting ML Matlab Examples to Python using JAX” under the Tensorflow organization. The goal of the project is to translate machine learning Matlab code to Python/Jax for Kevin Murphy’s second volume of his upcoming book “Probabilistic Machine Learning: Advanced Topics”." /><meta property="og:site_name" content="Gerardo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-06T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Google Summer of Code: week 0" /><meta name="twitter:site" content="@grrddm" /><meta name="twitter:creator" content="@Gerardo" /> <script type="application/ld+json"> {"description":"This week marked the end of week 0 of the 2021 Google Summer of Code (GSoC). This year, I got accepted to work on the “Converting ML Matlab Examples to Python using JAX” under the Tensorflow organization. The goal of the project is to translate machine learning Matlab code to Python/Jax for Kevin Murphy’s second volume of his upcoming book “Probabilistic Machine Learning: Advanced Topics”.","headline":"Google Summer of Code: week 0","dateModified":"2021-06-06T00:00:00+01:00","datePublished":"2021-06-06T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2021/06/06/gsoc0"},"url":"/2021/06/06/gsoc0","author":{"@type":"Person","name":"Gerardo"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title> Google Summer of Code: week 0 - Gerardo</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Gerardo" href="/atom.xml"><link rel="alternate" type="application/json" title="Gerardo" href="/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script src="https://kit.fontawesome.com/23a90fcaa1.js" crossorigin="anonymous"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Gerardo</h1>--><nav role="navigation"><ul><li><a href="/" >Writing</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav></header><section class="post"><h2>Google Summer of Code: week 0</h2><p>This week marked the end of week 0 of the 2021 Google Summer of Code (GSoC). This year, I got accepted to work on the “Converting ML Matlab Examples to Python using JAX” under the Tensorflow organization. The goal of the project is to <a href="https://github.com/probml/pyprobml">translate machine learning Matlab code to Python/Jax</a> for Kevin Murphy’s second volume of his upcoming book “Probabilistic Machine Learning: Advanced Topics”.</p><p>According to GSoC’s calendar, the first two weeks of GSoC are for “community bonding”. In fact, it is written that</p><blockquote><p>[the students, if accepted] spend a few weeks integrating with their organizations prior to the start of coding. Students then have 10 weeks to code, meeting the deadlines agreed upon with their mentors.</p></blockquote><p>It turns out that for the project I’m working on, the first two weeks of community bonding have been full of communication and <strong>lots</strong> of code. Our mentors, Kevin Murphy and Mahmoud Soliman have made of the first two weeks challenging but rewarding.</p><p>In what follows, I will give a brief overview of the things I learned, PRs I made, and graphs I plotted during my first two weeks.</p><h2 id="a-summary-of-the-past-two-weeks">A summary of the past two weeks</h2><h3 id="kalman-filters">Kalman Filters</h3><p><img src="https://imgur.com/wkpiotN.png" alt="kalman-filter-demo" /></p><p>One of the main challenges these past two weeks has been the creation of a small Kalman Filter library that uses Jax. In <a href="https://github.com/probml/pyprobml/blob/master/scripts/kalman_tracking_demo.py">this demo</a>, we used Jax to simulate a <em>firework</em> that moves at varying speed. We then compare the estimated trajectory given by the Kalman Filter equations v.s. the Kalman Smoothing equations.</p><p>At the beginning I wasn’t too sure why it was decided to use Jax given that we require for-loops to compute the Kalman Filters. However, it all payed off once we used Jax’s <code>vmap</code> for an impresive increase in speedup (see last subsection for more information).</p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/kalman_tracking_demo.py">scripts/kalman_tracking_demo.py</a></li><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/linear_dynamical_systems_lib.py">scripts/linear_dynamical_systems.py</a></li></ul><h3 id="mcmc-sampling">MCMC Sampling</h3><p float="left"> <img src="https://imgur.com/gsII0y3.png" width="220" /> <img src="https://imgur.com/80AW1N5.png" width="220" /> <img src="https://imgur.com/rEatXsy.png" width="220" /> <img src="https://imgur.com/ed1KC6J.png" width="220" /></p><p>Although most of the issues/figures to work on were asigned to us. I decided to self-assign the MCMC demo to me.</p><p>The plots above prefectly portray what is really happening in Gibbs and Metropolis-Hastings sampling. It’s a clear representation that these two methods of MCMC sampling return autocorrelated samples, which may be undesirable if we want to simulate an i.i.d. process. Furthermore, we can see the effect of the step-size in a run of the HM sampling algorithm.</p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/mcmc_gmm_demo.py">scripts/mcmc_gmm_demo.py</a></li></ul><h3 id="occasionally-dishonest-casino">Occasionally Dishonest Casino</h3><p float="left"> <img src="https://imgur.com/p9RUU6r.png" width="220" /> <img src="https://imgur.com/6hkqR7n.png" width="220" /> <img src="https://imgur.com/A37Dgsu.png" width="220" /></p><p>This has been one of my favorite examples so far. In an ocassionally dishonest casino, we assume that every time we throw a die, there is a certain proabbility that the die will either be biased –in which case, the probability of landing a 6 is 5/10 and all other numbers 1/10–, or be unbiased, i.e., every number has an equal 1/6 probability. The goal was to use a Hidden Markov Model (HMM) to recover the times in which the die was biased given that we only have the history of the numbers that appeared under the throw of a dice:</p><pre><code>x: 666333434452361543336162146653316146656663144434652652444446
z: 222222221111111111111111111111111112222222222222222211111111
</code></pre><p>The first plot (above) is the equivalent of the Kalman-Filter equation of a Hidden Markov Model. It tries to recover in real time whether a certain observation, conditional on previous observations, belongs to the biased state or the unbiased state. The second figure is the smoothing part that allows us to retroactively analyze whether any given throw is biased or unbiased. Finally, the last plot shows the most likely path using the Viterbi algorithm.</p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/hmm_casino_demo.py">scripts/hmm_casino_demo.py</a></li><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/hmm_lib.py">scripts/hmm_lib.py</a></li></ul><h3 id="more-kalman-filtering-fireworks">More Kalman Filtering: Fireworks</h3><p><img src="https://imgur.com/Xidy1Gq.png" /></p><p>The highlight of week zero for me came with Kevin’s proposal that we use Jax’s <code>vmap</code> function to speedup the Kalman Filter demo that I previously wrote. The goal was to run the Kalman Filter for 20 “fireworks” simultaneously. I was impressed to see that the speedup was around 80% using <code>vmap</code> on a Google Colab 2-core machine than using a for loop over simulations. The following was the result:</p><pre><code class="language-python">%%time
key = random.PRNGKey(27182)
for n in range(n_samples):
  lds_instance = lds.LinearDynamicalSystem(A, C, Q, R, μ0, Σ0, n_steps)
  result = sample_filter_smooth(key, lds_instance)

&gt; CPU times: user 10.8 s, sys: 1.18 s, total: 12 s
&gt; Wall time: 9.93 s
</code></pre><pre><code>%%time
key = random.PRNGKey(27182)
lds_instance = lds.ParallelLinearDynamicalSystem(A, C, Q, R, μ0, Σ0, n_steps)
result = sample_filter_smooth(key, lds_instance, n_samples, True)

&gt; CPU times: user 1.49 s, sys: 70.4 ms, total: 1.57 s
&gt; Wall time: 1.44 s
</code></pre><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/linear_dynamical_systems_lib.py">scripts/linear_dynamical_systems.py</a> (<code>vmap</code> version currently under review)</li><li><a href="">parallel_kalman_filter.py</a> (Currently under review)</li></ul><h3 id="more-kalman-filtering-imaginary-eigenvalue-systems">More Kalman Filtering: Imaginary-Eigenvalue systems</h3><p><img src="https://imgur.com/aYxc01X.png" /></p><p>One final application of the Kalman Filters that I worked on these past week consists in modeling a linear dynamical system with imaginary eigenvalues. Even though the observations may seem to stem from a nonlinear system, the system stills follows a linear evoluation over time, it follows that the Kalman Filter should work, and so it does!</p><ul><li><a href="">spiral_kalman_filter.py</a> (Currently under development)</li></ul><span class="meta"><time datetime="2021-06-06T00:00:00+01:00">June 6, 2021</time> &middot; <a href="/tag/gsoc">gsoc</a>, <a href="/tag/personal">personal</a></span></section></main></body></html>
