<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Google Summer of Code: week 1" /><meta name="author" content="Gerardo" /><meta property="og:locale" content="en_US" /><meta name="description" content="data, computers, and mathematics" /><meta property="og:description" content="data, computers, and mathematics" /><meta property="og:site_name" content="Gerardo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-13T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Google Summer of Code: week 1" /><meta name="twitter:site" content="@grrddm" /><meta name="twitter:creator" content="@Gerardo" /> <script type="application/ld+json"> {"datePublished":"2021-06-13T00:00:00+01:00","description":"data, computers, and mathematics","mainEntityOfPage":{"@type":"WebPage","@id":"/2021/06/13/gsoc1"},"url":"/2021/06/13/gsoc1","author":{"@type":"Person","name":"Gerardo"},"headline":"Google Summer of Code: week 1","dateModified":"2021-06-13T00:00:00+01:00","@type":"BlogPosting","@context":"https://schema.org"}</script><title> Google Summer of Code: week 1 - Gerardo</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Gerardo" href="/atom.xml"><link rel="alternate" type="application/json" title="Gerardo" href="/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script src="https://kit.fontawesome.com/23a90fcaa1.js" crossorigin="anonymous"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}</style><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-137916168-1', 'auto'); ga('send', 'pageview'); </script></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Gerardo</h1>--><nav role="navigation"><ul><li><a href="/" >Writing</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav></header><section class="post"><h2>Google Summer of Code: week 1</h2><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous" /><h2 id="a-summary-of-this-week">A summary of this week</h2><h3 id="mathematics-and-programming">Mathematics and programming</h3><p>A big discussion this week was about usability versus the readability of code. Last week I implemented the Kalman filter equations in Jax. To do this, I tried to keep the code as close to the math as possible. For example, the initial conditions of the Kalman filter can be written as follows:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">K</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="bold">Σ</mi><mn>0</mn></msub><mo>+</mo><msup><mi mathvariant="bold">C</mi><mi>T</mi></msup><mrow><mo fence="true">(</mo><mi mathvariant="bold">C</mi><msub><mi mathvariant="bold">Σ</mi><mn>0</mn></msub><msup><mi mathvariant="bold">C</mi><mi>T</mi></msup><mo>+</mo><mi mathvariant="bold">R</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold-italic">μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="bold-italic">μ</mi><mn>0</mn></msub><mo>+</mo><msub><mi mathvariant="bold">K</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">x</mi><mn>0</mn></msub><mo>−</mo><mi mathvariant="bold">C</mi><msub><mi mathvariant="bold-italic">μ</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi mathvariant="bold">Σ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold">I</mi><mo>−</mo><msub><mi mathvariant="bold">K</mi><mn>1</mn></msub><mi mathvariant="bold">C</mi><mo stretchy="false">)</mo><msub><mi mathvariant="bold">Σ</mi><mn>0</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} {\bf K}_1 &amp;= \bold{\Sigma}_0 + {\bf C}^T \left({\bf C} \bold{\Sigma}_0 {\bf C}^T + {\bf R}\right)\\ {\boldsymbol \mu}_1 &amp;= {\boldsymbol \mu_0} + {\bf K}_1 ({\bf x}_0 - {\bf C} {\boldsymbol \mu}_0)\\ \bold{\Sigma}_1 &amp;= ({\bf I} - {\bf K}_1 {\bf C}) \bold{\Sigma}_0 \end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.551330999999999em;vertical-align:-2.0256654999999997em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5256655em;"><span style="top:-4.6343345000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.1343345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6343345000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0256654999999997em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5256655em;"><span style="top:-4.6343345000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">R</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.1343345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">μ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.6343345000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">I</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span></span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.0256654999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>To implement this set of equations in Jax, I wrote the following code</p><pre><code class="language-python">K1 = self.Σ0 @ self.C.T @ inv(self.C @ self.Σ0 @ self.C.T + self.R)
μ1 = self.μ0 + K1 @ (x_hist[0] - self.C @ self.μ0)
Σ1 = (I - K1 @ self.C) @ self.Σ0
</code></pre><p>One problem with the previous code, however, is the hardship to explicitly initialize the class due to the presence of the Greek symbols. To solve this, it was proposed to write <code>Sigma</code> instead of <code>Σ</code>, and <code>mu</code> instead of <code>μ</code>. The resulting code was the following:</p><pre><code class="language-python">K1 = self.Sigma0 @ self.C.T @ inv(self.C @ self.Sigma0 @ self.C.T + self.R)
mu1 = self.mu0 + K1 @ (x_hist[0] - self.C @ self.mu0)
Sigma1 = (I - K1 @ self.C) @ self.Sigma0
</code></pre><p>Although the final code did not look ugly, this issue made think of the code we write and context it surrounds it. If a code tries to teach rather than be used in <em>production</em>, I believe it is fair to use greek symbols. It would be painful to use <em>scikit-learn</em> and initialize a variable <code>α</code> in multiple models. However, if I’m looking to directly translate some math concept that I’ve already understood into code, the easiest way to do this is to write code as close as possible to the math.</p><p>File</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/linear_dynamical_systems_lib.py"><code>linear_dynamical_systems_lib.py</code></a></li></ul><h3 id="parallel-and-spiral-kalman-filters">Parallel and Spiral Kalman Filters</h3><p>A second refactoring task this week was to clean the <a href="https://github.com/probml/pyprobml/blob/master/scripts/parallel_kalman_filter_demo.py"><code>parallel_kalman_filter_demo.py</code></a> and making sure that it works using the class <code>LinearDynamicalSystem</code> inside the <a href="https://github.com/probml/pyprobml/blob/master/scripts/linear_dynamical_systems_lib.py"><code>linear_dynamical_systems_lib.py</code></a> without break the previously-implemented <a href="https://github.com/probml/pyprobml/blob/master/scripts/kalman_tracking_demo.py"><code>kalman_tracking_demo.py</code></a>. It wasn’t the most exciting task of the week, but in the end I got a pretty refactored graph of tracking multiple fireworks at once.</p><p float="left"> <img src="https://imgur.com/rhizw9D.png" width="300" /> <img src="https://imgur.com/9YvfgsR.png" width="300" /> <img src="https://imgur.com/b0AhLYl.png" width="300" /></p><p>A final Kalman filter task this week was to clean and upload the <code>kalman_filter_spiral_demo.py</code> of a system with imaginary eigenvalues. Although I got some pretty results last week, this week I made sure that the code was pretty and worked.</p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/parallel_kalman_filter_demo.py"><code>parallel_kalman_filter_demo.py</code></a></li><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/kalman_filter_spiral_demo.py"><code>kalman_filter_spiral_demo.py</code></a></li></ul><h3 id="extended-kalman-filtering-ekf">Extended Kalman Filtering (EKF)</h3><p>After multiple days of refactoring, I got to play with my favourite example this week. The idea is fairly simple (although to really understand what is going on, it’s better to read PML Vol 2 book). The <em>classical</em> Kalman filter equations only work when both the latent and the observed space are linear. If either the observed space or the latent-space do not emerge from a linear system, the Kalman filter equations cannot capture the latent space from the observed data. The idea behind the EKF is to make a first-order approximation to capture the latent behaviour of a nonlinear dynamical system. To exemplify this, I proposed we used the following nonlinear dynamical system with identity observed function:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>x</mi><mo>˙</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>y</mi><mo>˙</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mn>3</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} \dot x &amp;= y\\ \dot y &amp;= x - x ^ 3 \end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.024108em;vertical-align:-1.262054em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.762054em;"><span style="top:-3.922054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.11111000000000001em;"><span class="mord">˙</span></span></span></span></span></span></span></span></span><span style="top:-2.397946em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.08333000000000002em;"><span class="mord">˙</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.262054em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.762054em;"><span style="top:-3.922054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.397946em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.262054em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>The interesting bit in this example is to realize that the dynamics to capture are comprised of a set of differential equations. Furthermore, when tracking an object using EKF we may not observe every single sample. Hence, we first simulated the latent state space; then we added some noise to obtain the observations; finally, we divided the observations into evenly-spaced intervals and tried to recapture the latent space. What resulted was an interesting example where, in order to recover the latent dataset, we used Runge-Kutta to integrate between two observed samples.</p><p float="left"> <img src="https://imgur.com/fmE1dyL.png" width="300" /> <img src="https://imgur.com/bndlIh1.png" width="300" /></p><p>Files</p><ul><li><a href="https://github.com/probml/pyprobml/blob/master/scripts/extended_kalman_filter_demo.py"><code>extended_kalman_filter_demo.py</code></a></li></ul><h2 id="variational-mixture-of-gaussian-distributions">Variational Mixture of Gaussian distributions</h2><p>The final example I worked on this week was the variational mixture of Gaussians example using TensorFlow Probability (TFP) and Jax. The goal was to show how the variational mixture of Gaussians with a pre-specified factorization and selection of prior distributions give rise to a model that finds clusters in the data and eliminates clusters that have low probability.</p><p>The following two figure shows the first and 100th iteration of the model. At the beginning we pre-specified 6 clusters. Each cluster tries to find a group of points to bound to. As the iterations progress, if there is not enough data to support one cluster, that cluster gets eliminated.</p><p float="left"> <img src="https://imgur.com/Tg6tDLF.png" width="300" /> <img src="https://imgur.com/t6HDpI7.png" width="300" /></p><p>In the next picture, we show the number of points attach to a cluster. As the iterations progresses, we see how all but two clusters remain “alive”.</p><p float="left"> <img src="https://imgur.com/YntNTvn.png" width="300" /> <img src="https://imgur.com/zskmC6K.png" width="300" /></p><span class="meta"><time datetime="2021-06-13T00:00:00+01:00">June 13, 2021</time> &middot; <a href="/tag/gsoc">gsoc</a>, <a href="/tag/personal">personal</a></span></section></main></body></html>
